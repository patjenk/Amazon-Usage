Forked from https://gist.github.com/812303. I know I didn't do this correctly but gists are a foreign concept to me and I am under the gun.
